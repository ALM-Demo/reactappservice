name: deploy
'on':
  push:
    paths:
    - .github/workflows/appservice_workflow.yml
env:
  DOCKER_IMAGE_NAME: "alm-react-appservice-poc1"
  AZURE_WEB_APP: "alm-react-appservice-poc1"
  REGISTRY_NAME: "acralmpoc"

jobs:

  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Azure Login
      uses: azure/login@v1
      with:
        creds: ${{ secrets.AZURE_CREDENTIALS }}
    - run: |
       dpwd=$(az acr credential show -n $REGISTRY_NAME --query "passwords[0].value"  -o tsv)
       echo $dpwd | docker login acralmpoc.azurecr.io --username $REGISTRY_NAME --password-stdin
       #echo $dpwd | docker login docker.pkg.github.com -u USERNAME 
       #az acr credential show -n $REGISTRY_NAME --query passwords[0].value
       #az acr login -name $REGISTRY_NAME --expose-token

